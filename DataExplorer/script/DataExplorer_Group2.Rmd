---
title: "DataExplorer Package"
author: "Cynthia Petrossian, Sally Heo, Tadeo Zuniga, Heather Carstensen"
date: "4/9/2022"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: sandstone
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.path = "../output/", echo = TRUE, warning = FALSE, message = FALSE)
```

## Load libraries and data

First install the DataExplorer package:

install.packages("DataExplorer")

Then load the packages and read in the data. We're using the chemicaldata_maunalua.csv data frame we used previously during Week 7. 

```{r}
library(here)
library(DataExplorer)
library(tidyverse)

chem <- read_csv(here("DataExplorer", "data", "chemicaldata_maunalua.csv"))
```

## Making Plots

```{r histogram}
plot_histogram(chem)
```

```{r density}
plot_density(chem)
```



## plot_bar Function

If you would like to see the frequency distribution of discrete variables, use the plot_bar function. This will display bar charts showing the frequency of each character value, faceted by column. 

By default, this function will ignore any columns that have more than 50 different character values. This threshold can be altered with the argument "maxcat = "  


```{r plot_bar_1}
plot_bar(chem)  #make bar plots for all discrete variables using the chem data
```

Some other useful arguments include:

* [by = ], allows you to map color within the bars to a second discrete variable. The default setting creates stacked bars with colors corresponding to that variable (see example below). 
* [by_position = ""] allows you to change the position argument if you are creating  bars "by" another variable. The default is "fill". Another option is "dodge", which will instead display grouped bars side-by-side rather than stacked bars (see example below).
* [title = ""] allows you to add a title to the set of plots.
* [ggtheme = ] allows you to apply a ggplot2 theme to the plots.
* [nrow = ] allows you to change the number of plots displayed per row. The default is 3 per row (3L). 
* [ncol = ] allows you to change the number of plots per column. The default is 3 per column (3L).

If you would like to see the distribution of another discrete column within the bars, you can add by = "column name", and now color within each bar will be mapped to that second discrete variable. Let's also add a ggplot2 theme. 

```{r plot_bar_2}
plot_bar(chem,  #Make bar plots for discrete variables with the chem data
         by = "Site",  #Map colors within the bars to Site
         theme = theme_bw())  #Change theme
```


## plot_boxplot Function

The plot_boxplot feature allows you to look at the distribution of numeric values for a chosen discrete column, so this is a way to compare discrete and numeric data. Let's look at the distributions of all numeric columns when we organize the data by Zone.

```{r plot_boxplot}
plot_boxplot(chem,  #Make boxplots using chem data frame
             by = "Zone")  #Organize by the discrete variable Zone
```

Now we see all the values for "Zone" displayed on the y-axis, and continuous numeric values for each plot are on the x-axis. This function can help the user you to identify patterns across variables. For example, the Near Spring shows different value distributions than the other zones for several of the continuous variables, including NN (Nitrate+nitrite), percent_sgd (Relative amount of submarine groundwater discharge in the water), pH, Phosphate, Salinity, Silicate, and TA (Total alkalinity). 

Many of the same arguments listed above for plot_bar can also be used here for plot_boxplot. 

## Function: plot_correlation ##

* This function creates a correlation heatmap for discrete features 
* Discrete data is quantitative data that relies on counts in whole numbers or decimals.
* Analyze correlation in your data

```{r plot_correlation, warning=FALSE, message=FALSE}
plot_correlation(chem,#Input the data, in this case it is chem
                 type = c("all", "discrete", "continuous"), #The column types to be included in the correlation plot; "All" = all columns, "discrete" is for discrete features, "continuous" is for continuous. 
                 maxcat = 20L, #Maximum categories allowed for each discrete feature
                 cor_args = list(),# List of arguments to be passed to the plot correlation function
                 geom_text_args = list(), #List of arguments to geom_text
                 title = NULL, #Plot title, NULL is the default (no title)
                 ggtheme = theme_classic(), #Setting theme_classic
                 theme_config = list(legend.position = "bottom", axis.text.x = element_text(angle = 90))#Adjusting axis text, and legend position
                 )
```

## Function(a): create_report() ##

* This function creates a data profiling report for our Chem Data
* Organizes the data profiling statistics into a report
* This is a really important function and runs most of the explatory data analysis (EDA) functions and gives a output html file. 

## Function (b): configure_report()

* This function allows us to customize each individual section of the data profiling report
* We can turn off sections of the data report that we don't want to show
* We can also set a global theme
* For example for add_plot qq = FALSE, if we change FALSE to TRUE, the qq plot will be included in the data profiling report.
* We can also configure a report where only QQ and box plots are included and the correlation analysis is not added.

## Arguments ##
* add_plot_qq: Specifies whether or not the QQ plot is added in the report
* add_plot_boxplot: Specifies whether or not the boxplot is added in the report
* add_plot_histogram: Specifies whether or not the histogram is added to the report
* add_plot_correlation: Specifies whether or not the correlation analysis is added to the report
* global_ggtheme: The global setting and to set the theme of the report (ie theme_minimal, theme_gray, theme_few) 

```{r}
config <- configure_report( #config argument, the report configuration generated by configure_report
  add_plot_qq = TRUE, #Show qq plot in the data profiling report
  add_plot_boxplot = TRUE, #show the boxplot in the data profiling report
  add_plot_histogram = TRUE, #show the histogram in the data profiling report
  add_plot_correlation = TRUE, #show the correlation analysis in the data profiling report
  global_ggtheme = quote(theme_gray(base_size = 14)) #Setting global setting for the theme of the report
)
create_report(chem, config = config) #creates a data profiling report
```
```{r}


```




